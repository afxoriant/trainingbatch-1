CODE ADDED FOR NEW FEATURE